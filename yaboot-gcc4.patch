--- yaboot-1.3.13/lib/strstr.c.orig	2001-09-20 15:15:31.000000000 +0200
+++ yaboot-1.3.13/lib/strstr.c	2005-12-09 17:16:58.000000000 +0100
@@ -65,8 +65,18 @@
         {
           register chartype a;
 	  register const unsigned char *rhaystack, *rneedle;
+	  
+	  a = *++haystack;
+	  if (a == '\0')
+	      goto ret0;
+	  if (a == b)
+              break;
+	  a = *++haystack;
+	  if (a == '\0')
+              goto ret0;
 
-	  do
+	 do {
+	  while (a != b)
 	    {
 	      a = *++haystack;
 	      if (a == '\0')
@@ -76,15 +86,13 @@
 	      a = *++haystack;
 	      if (a == '\0')
 		goto ret0;
-shloop:	    }
-          while (a != b);
+	    }
 
 jin:	  a = *++haystack;
 	  if (a == '\0')
 	    goto ret0;
 
-	  if (a != c)
-	    goto shloop;
+	} while ( a != c );
 
 	  rhaystack = haystack-- + 1;
 	  rneedle = needle;
